RAGでのフォルダ接続とデータ加工（A4 1枚想定）
====================================

結論
- 「フォルダをそのまま接続」は“入口”として可能だが、実用的なRAGにするには
  最終的に「チャンク化＋ベクトル化（索引化）」した方が圧倒的に強い。
- 多くのRAGアプリは、フォルダ指定→内部で自動的に「抽出・分割・埋め込み・保存」を行う。
  つまり「フォルダ接続できるか」は、裏で索引化まで自動化できるかの違い。


フォルダ接続（取り込み）で内部的に起きる典型フロー
------------------------------------
1) フォルダ内のファイル列挙（PDF/Word/Excel/txt/MD 等）
2) テキスト抽出（PDFは崩れやすい）
3) テキストをチャンク（小分け）に分割
4) チャンクごとに埋め込み（Embedding）→ベクトル化
5) ベクトルDBに保存（索引化）
6) 質問時：質問もベクトル化→近いチャンクを検索→LLMへ渡して回答


どちらが良いか（判断基準）
------------------------------------
A) フォルダ接続＋自動索引（最速運用向き）
- 期限が近い／担当が少ない／まず動くものが必要
- 文書更新が頻繁で、人手で加工したくない
- 精度は最初80点でOK、後から改善する前提

B) 自分で加工（チャンク化・ベクトル化）して作り込む（精度・統制向き）
- PDF地獄（スキャン/表/改行崩れ）が多い、形式がバラバラ
- 誤回答が怖い（規程・品質・監査）
- 根拠（どの文書のどの箇所か）を厳密に残したい
- 部署ごとのアクセス権など、検索結果に権限制御を入れたい


おすすめの進め方（スピード最優先の現実解）
------------------------------------
フェーズ1（最短で稼働）
- フォルダを指定してRAGアプリに取り込ませる（自動でチャンク化＋ベクトル化）
- 追加/更新のルール（例：夜間に再取り込み、更新フォルダのみ再索引）を決めて回す

フェーズ2（痛いところだけ改善）
- PDFだけ別処理で抽出改善
- チャンク粒度を「見出し単位」「章単位」などに変更
- メタデータ（部署/版/文書種別）を付与してフィルタ検索を追加


「チャンク化＋ベクトル化」は必須？
------------------------------------
- RAGとして“検索で当てる”なら実質必須。
- 全文を毎回LLMに渡す方式は、
  (1) トークン制限で入らない (2) 遅い/高コスト (3) 根拠が曖昧 (4) 誤参照が増える
  などで破綻しやすい。


失敗しやすいポイント（先回り）
------------------------------------
- PDF：文字抽出不可、改行崩れ、表の崩壊
- Excel：シート構造が意味を持つため抽出方式で精度が激変
- 更新：古い版が混ざると古い規程を引用して事故る
- 権限：フォルダ権限とRAG検索権限の不一致は危険

（以上）
